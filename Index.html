<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>$WATT ‚Äî Ride to Earn</title>
  <style>
    :root {
      --primary: #00ff7f;
      --accent: #00e0ff;
      --background: #0a0a0a;
      --text: #f2f2f2;
      --card: #1a1a1a;
      --shadow: rgba(0, 0, 0, 0.4);
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', 'Roboto', sans-serif;
      background: var(--background);
      color: var(--text);
    }
    header {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: #000;
      padding: 4rem 2rem;
      text-align: center;
      border-bottom: 4px solid var(--primary);
    }
    header h1 {
      font-size: 3.5rem;
      margin: 0 0 1rem;
    }
    header p {
      font-size: 1.25rem;
      margin-bottom: 2rem;
    }
    .button {
      display: inline-block;
      background: #000;
      color: var(--primary);
      border: 2px solid var(--primary);
      padding: 0.8rem 2rem;
      font-size: 1rem;
      font-weight: bold;
      border-radius: 999px;
      transition: all 0.3s ease;
      text-decoration: none;
    }
    .button:hover {
      background: var(--primary);
      color: #000;
      transform: scale(1.05);
    }
    main {
      padding: 2rem;
      max-width: 960px;
      margin: auto;
    }
    section {
      background: var(--card);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 20px var(--shadow);
    }
    h2 {
      color: var(--primary);
      margin-top: 0;
    }
    .steps, .leaderboard ol {
      padding-left: 1rem;
    }
    .step {
      margin-bottom: 1rem;
    }
    input, button {
      font-size: 1rem;
      padding: 0.75rem;
      margin-top: 1rem;
      border: none;
      border-radius: 10px;
    }
    input {
      width: calc(100% - 2rem);
      max-width: 300px;
    }
    .leaderboard li {
      margin-bottom: 0.5rem;
    }
    footer {
      text-align: center;
      padding: 2rem;
      font-size: 0.875rem;
      color: #aaa;
    }
  </style>
</head>
<body>
  <header>
    <h1>$WATT</h1>
    <p>üö¥‚Äç‚ôÇÔ∏è Mint crypto with every ride. No miners, just muscles.</p>
  <a class="button" href="https://www.strava.com/oauth/authorize?client_id=161922&response_type=code&redirect_uri=https://melodious-queijadas-d749fe.netlify.app/.netlify/functions/strava-auth&approval_prompt=auto&scope=activity:read_all">
  üö¥ Connect Strava Now
</a>

  </header>

  <main>

    <section id="how-it-works">
      <h2>How It Works</h2>
      <div class="step"><strong>1. Track Power:</strong> Ride with a power meter. We measure real wattage output.</div>
      <div class="step"><strong>2. Sync GPS:</strong> We verify distance + effort with Strava data.</div>
      <div class="step"><strong>3. Mint $WATT:</strong> Convert watt-hours into crypto. 1000 Wh = 1 $WATT.</div>
      <div class="step"><strong>4. Use or Flex:</strong> Spend it or save it. Compete, flex, or trade.</div>
    </section>

    <section id="calculator">
      <h2>Watt-to-$WATT Calculator</h2>
      <form id="wattForm">
        <input type="number" id="wattHours" placeholder="Enter watt-hours (Wh)" required />
        <br />
        <button type="submit" class="button">Calculate</button>
      </form>
      <div id="result"></div>
    </section>

    <section class="leaderboard">
      <h2>Top Riders (Demo)</h2>
      <ol>
        <li>@Quadzilla ‚Äî 3,200 Wh</li>
        <li>@ChainGang ‚Äî 2,870 Wh</li>
        <li>@MomOnFixie ‚Äî 2,450 Wh</li>
      </ol>
    </section>
  </main>
  <section id="connect">
      <h2>Connect with Strava</h2>
      <p>Start earning by syncing your rides. We pull wattage and GPS data to mint real $WATT into your wallet.</p>
      <a class="button" href="https://www.strava.com/oauth/authorize?client_id=161922&response_type=code&redirect_uri=melodious-queijadas-d749fe.netlify.app>üö¥ Connect Strava Now</a>
    </section>
<section id="connect">
  <h2>Connect with Strava</h2>
  <p>Start earning by syncing your rides. We pull wattage and GPS data to mint real $WATT into your wallet.</p>
  <a class="button" href="https://www.strava.com/oauth/authorize?client_id=161922&response_type=code&redirect_uri=https://melodious-queijadas-d749fe.netlify.app/.netlify/functions/strava-auth&approval_prompt=auto&scope=activity:read_all">
    üö¥ Connect Strava Now
  </a>
</section>

    <section id="your-balance">
      <h2>Your $WATT</h2>
      <div id="watt-display">Loading your $WATT balance...</div>
    </section>

  <footer>
    üî• $WATT ‚Äî Ride to Earn. Built for the streets. ¬© 2025
  </footer>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const athleteId = urlParams.get('athlete_id');
    if (athleteId) localStorage.setItem("athlete_id", athleteId);

    let walletBalance = localStorage.getItem('wattWallet') || 0;
    document.getElementById('mintResult')?.innerHTML = `üí∞ Wallet Balance: <strong>${walletBalance}</strong> $WATT`;

    document.getElementById('wattForm')?.addEventListener('submit', function(e) {
      e.preventDefault();
      const wh = parseFloat(document.getElementById('wattHours').value);
      const rate = 10;
      const earned = (wh / rate).toFixed(2);
      document.getElementById('result').innerText = `üí∞ You would earn approximately ${earned} $WATT`;
    });
  </script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAuklQzaRb5kqqn3WiwqLQDOvFo6JdYgMA",
      authDomain: "wattcoinstorage.firebaseapp.com",
      projectId: "wattcoinstorage",
      storageBucket: "wattcoinstorage.firebasestorage.app",
      messagingSenderId: "602389391177",
      appId: "1:602389391177:web:3ed75f3ae32bfa108d9c98",
      measurementId: "G-FBVDXX0P0W"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const athleteId = localStorage.getItem("athlete_id");

    if (athleteId) {
      const docRef = doc(db, "users", athleteId);
      getDoc(docRef).then(docSnap => {
        if (docSnap.exists()) {
          const data = docSnap.data();
          document.getElementById("watt-display").innerText =
            `You've earned ${data.watt_token} $WATT from ${data.activities_count} rides. üö¥üî•`;
        } else {
          document.getElementById("watt-display").innerText = "No ride data found.";
        }
      });
    }
  </script>
</body>
</html>
